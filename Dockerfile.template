FROM python:3.6.3

ENV PORT=80

WORKDIR /code
COPY . .

RUN pip install -r requirements.txt

ENV PROXY_FQDN=${PROXY_FQDN}
ENV ES_ENDPOINT=${ES_ENDPOINT}
ENV OPENID_PROVIDER=accounts.google.com
ENV OAUTH2_CLIENT_ID=${OAUTH2_CLIENT_ID}
ENV OAUTH2_CLIENT_SECRET=${OAUTH2_CLIENT_SECRET}
ENV ASSUME_ROLE_ARN=arn:aws:iam::${ACCOUNT_ID}:role/elk-oidc-proxy
ENV HEALTHCHECK_ACCOUNT_EMAIL=${HEALTHCHECK_ACCOUNT_EMAIL}

CMD ["python", "app.py"]
